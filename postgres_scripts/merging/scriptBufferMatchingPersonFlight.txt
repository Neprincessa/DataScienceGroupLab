create table public."BufferMatchingPersonFlight"(
	ticket_number VARCHAR(30) NOT NULL,
	passenger_document VARCHAR(30) NOT NULL
);

TRUNCATE public."BufferMatchingPersonFlight";

INSERT INTO 
 public."BufferMatchingPersonFlight"
SELECT DISTINCT 
 BD.ticket_number,
 BD.passenger_document
FROM 
 public."BoardingData" as BD
WHERE
 BD.ticket_number IS NOT NULL
 AND BD.ticket_number != 'Not presented'
 AND BD.passenger_document IS NOT NULL;
 
INSERT INTO 
 public."BufferMatchingPersonFlight"
SELECT DISTINCT 
 S.code_e_ticket,
 S.traveldoc
FROM 
 public."Sirena" as S
WHERE
 S.code_e_ticket NOT IN (SELECT ticket_number FROM public."BufferMatchingPersonFlight")
 AND S.code_e_ticket IS NOT NULL
 AND S.code_e_ticket != 'Not presented'
 AND S.traveldoc IS NOT NULL; 

SELECT * FROM public."BufferMatchingPersonFlight";
